
%h2.page-header
  = t('.title')
  .pull-right
    -if params[:node]
      = link_to t('.all'), switch_path, :class => 'btn'
.page-header-bottom

- @switches.sort.each do |switch, sw_details|
  - max_port = (sw_details[:max_port]<25 ? 24 : 48)
  %table.switch.table.table-bordered{ :id=>switch }
    %thead
      %tr 
        %th{:colspan=>"12" }
          .inline_piechart.pull-left= [sw_details[:status]["ready"], sw_details[:status]["failed"], sw_details[:status]["unknown"], sw_details[:status]["unready"]+sw_details[:status]["pending"]] * ","
          %a.toggle.with_label{:href => "#", :id => "#{switch.parameterize}_toggle", :rel => "#{switch.parameterize}_details1, #{switch.parameterize}_details25"}
            = t('.switch') + " : " + switch
    %tbody
      %tr
        - (@port_start).step(max_port-1, 2) do |port|
          =render :partial => 'dense', :locals => { :switch=> switch, :sw_details=>sw_details, :port=>port, :max_port=>max_port } 
      %tr
        - (@port_start+1).step(max_port, 2) do |port|
          =render :partial => 'dense', :locals => { :switch=> switch, :sw_details=>sw_details, :port=>port, :max_port=>max_port } 

  %table.switch.table.table-bordered{ :id=>"#{switch.parameterize}_details1", :style=>"display:none" }
    %thead
      %tr
        %th{:colspan=>"24" }
          = t('.switch_details') + " : " + switch
    %tbody
      %tr
        - (@port_start).step((@port_start+22), 2) do |port|
          =render :partial => 'switch', :locals => { :switch=> switch, :sw_details=>sw_details, :port=>port } 
      %tr
        - (@port_start+1).step((@port_start+23), 2) do |port|
          =render :partial => 'switch', :locals => { :switch=> switch, :sw_details=>sw_details, :port=>port } 
  -if max_port>24
    %table.switch.table.table-bordered{ :id=>"#{switch.parameterize}_details25", :style=>"display:none" }
      %thead
        %tr
          %th{:colspan=>"24" }
            = t('.switch_details') + " : " + switch
      %tbody
        %tr
          - (@port_start+24).step(max_port-1, 2) do |port|
            =render :partial => 'switch', :locals => { :switch=> switch, :sw_details=>sw_details, :port=>port } 
        %tr
          - (@port_start+25).step(max_port, 2) do |port|
            =render :partial => 'switch', :locals => { :switch=> switch, :sw_details=>sw_details, :port=>port } 

.clear

:javascript

   // set highlights on hover
  $('div.port')
    .hover( 
      //hover in
      function(ev) {
        var node = $(this).attr('node');
        $('div.port[node='+node+']').addClass('edge');
      },
      //hover out 
      function(ev) {
        var node = $(this).attr('node');
        $('div.port[node='+node+']').removeClass('edge');      
      }
    );
